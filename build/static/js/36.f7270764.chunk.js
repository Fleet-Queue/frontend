"use strict";(self.webpackChunkberry_free_material_react_cra=self.webpackChunkberry_free_material_react_cra||[]).push([[36],{8999:function(e,o,t){t.d(o,{Z:function(){return x}});var n=t(7313),a=t(3497),l=t(1629),r=t(6835),c=t(3477),i=t(4076),s=t(7478),d=t(3467),u=t(1095),h=t(9848),f=t(6167),m=t(5842),p=t(6417);function x(e){let{data:o,header:t,isShowSerialNo:x=!1,isShowAction:v=!1,actions:j=["Edit","Delete"],onActionChange:Z,onClickAction:g,refreshData:y}=e;const[k,I]=(0,n.useState)(null),[C,A]=(0,n.useState)(null),[N,S]=(0,n.useState)(null),[b,w]=(0,n.useState)(null),[D,_]=(0,n.useState)(!1);return(0,p.jsxs)(a.Z,{children:[(0,p.jsx)(l.Z,{children:(0,p.jsxs)(r.Z,{children:[(0,p.jsx)(c.Z,{children:(0,p.jsxs)(i.Z,{children:[x&&(0,p.jsx)(s.Z,{sx:{color:"primary.main"},children:"SLNO"}),t.map(((e,o)=>(0,p.jsx)(s.Z,{sx:{color:"primary.main"},children:e},o))),v&&(0,p.jsx)(s.Z,{sx:{color:"primary.main"},children:"Action"})]})}),(0,p.jsx)(d.Z,{children:o.map(((e,o)=>(0,p.jsxs)(i.Z,{onClick:()=>(e=>{g&&g(e)})(e._id),children:[x&&(0,p.jsx)(s.Z,{children:o+1}),t.map(((o,t)=>{if("IMAGE"===o.toUpperCase())return(0,p.jsx)(s.Z,{children:(0,p.jsx)("img",{style:{height:"100px"},src:`${e[`${o}`]}`,alt:"img"})},t);if("allocated"!=e.status&&"ALLOCATION"===o.toUpperCase())return console.log("dfffffffffffffffffffffffffffffffffffff"),console.log(e),(0,p.jsx)(s.Z,{children:(0,p.jsx)(u.Z,{variant:"contained",onClick:()=>(e=>{console.log("select alloccccccccccccccccccccccc"),console.log(e),console.log("heeeeeeeeeeeeeeeeeeeeeeedataaaaaaaaaaaaaaaa"),I(e.truckType),A(e.date),w(e.doId),console.log(e.truckType),_(!0)})({doId:e._id,truckType:e.truckType,date:e["available from"]}),children:"Allocate"})},t);if("allocated"==e.status&&"ALLOCATION"===o.toUpperCase())return(0,p.jsx)(s.Z,{children:(0,p.jsx)(u.Z,{variant:"contained",onClick:()=>{return o=e._id,S(o),void _(!0);var o},children:"View Allocation"})},t);if("VIEW DO"===o.toUpperCase()){const o=e["view DO"]||e.deliveryOrderId&&e.deliveryOrderId.doLink;return o?(0,p.jsx)(s.Z,{children:(0,p.jsx)(u.Z,{variant:"contained",onClick:()=>window.open(o,"_blank"),children:"View File"})},t):(0,p.jsx)(s.Z,{children:(0,p.jsx)(u.Z,{variant:"contained",disabled:!0,children:"No File"})},t)}return"isHighRangeArea"!=e.status&&"ISHIGHRANGEAREA"===o.toUpperCase()?(0,p.jsx)(s.Z,{children:e[`${o}`]?"Yes":"No"},t):"STATUS"===o.toUpperCase()?(0,p.jsx)(s.Z,{children:e[`${o}`]?"Active":"Inactive"},t):(0,p.jsx)(s.Z,{children:e[`${o}`]},t)})),v&&(0,p.jsx)(s.Z,{children:(0,p.jsx)(h.Z,{data:e,onActionChange:e=>{Z(e)},actions:j})})]},o)))})]})}),k&&(0,p.jsx)(f.Z,{open:D,close:()=>{I(null),console.log("heeeeeeeeeeeeeeeeeeeeeeeey"),y(),_(!1)},doId:b,date:C,type:k}),N&&(0,p.jsx)(m.Z,{open:D,close:()=>{S(null),y(),_(!1)},doId:N})]})}},5266:function(e,o,t){t.d(o,{h:function(){return l}});var n=t(6031),a=t.n(n);const l=(e,o,t)=>e.map((e=>a().mapKeys(e,((e,n)=>{for(let a=0;a<t.length;a++)if(n===o[a])return t[a];return n}))))},1036:function(e,o,t){t.r(o),t.d(o,{default:function(){return S}});var n=t(7313),a=t(7890),l=t(2832),r=t(8999),c=t(5266),i=t(4605),s=t(3208),d=t(5904),u=t(9536),h=t(9019),f=t(1387),m=t(1322),p=t(5713),x=t(8737),v=t(1095),j=t(5660),Z=t(658),g=t.n(Z),y=t(6417);const k=["Do No.","Name","Location","Company Name","name","View DO","availableFrom","status","allocation"];function I(e){let{partyId:o,data:t,updateData:a,selectedDate:l,setSelectedDate:Z}=e;const[I,C]=(0,n.useState)(!1),[A,N]=(0,n.useState)(),S=(0,c.h)(t,["doNumber","name","location","companyName","truckType","link","availableFrom","status"],k),b=()=>{a(o,l.format("DD/MM/YYYY"))};console.log(A);return(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(u.Z,{sx:{mb:2},children:(0,y.jsxs)(h.ZP,{container:!0,spacing:2,alignItems:"center",children:[(0,y.jsx)(h.ZP,{item:!0,xs:12,md:6,children:(0,y.jsx)(s._,{dateAdapter:d.y,children:(0,y.jsx)(i.M,{label:"Select Date",value:l,onChange:e=>Z(e),slotProps:{textField:{size:"small",fullWidth:!0}}})})}),(0,y.jsx)(h.ZP,{item:!0,xs:12,md:6,children:(0,y.jsx)(v.Z,{variant:"contained",startIcon:(0,y.jsx)(j.Z,{}),onClick:()=>{const e=[];t.forEach((o=>{(async o=>{try{var n,a,r,c,i,s,d,u,h,p,v,j;const f=await(0,m.ut)({doBookingId:o._id}),Z={"Sl No":e.length+1,"Registration Number":(null===(n=f.truckBookingId)||void 0===n||null===(a=n.truck)||void 0===a?void 0:a.registrationNumber)||"N/A",Company:(null===(r=o.deliveryOrderId)||void 0===r||null===(c=r.companyId)||void 0===c?void 0:c.name)||"N/A","Company Phone ":(null===(i=o.deliveryOrderId)||void 0===i||null===(s=i.companyId)||void 0===s||null===(d=s.contactNumber)||void 0===d?void 0:d.toString())||"N/A","DO Number":(null===(u=o.deliveryOrderId)||void 0===u?void 0:u.doNumber)||"",Location:(null===(h=o.deliveryOrderId)||void 0===h?void 0:h.location)||"N/A","Truck Type":`${o.truckType} FT`,Status:o.status,"Allocation Date":g()(o.updatedAt).format("DD/MM/YYYY HH:mm"),"Truck Company":(null===f||void 0===f||null===(p=f.truckBookingId)||void 0===p||null===(v=p.truck)||void 0===v||null===(j=v.companyId)||void 0===j?void 0:j.name)||"N/A"};if(e.push(Z),e.length===t.length){const o=x.P6.book_new(),t=x.P6.json_to_sheet(e);x.P6.book_append_sheet(o,t,"Bookings");const n=(0,x.cW)(o,{bookType:"xlsx",type:"array"}),a=`Allocated_Bookings_${l.format("DD-MM-YYYY")}.xlsx`,r=new Blob([n],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),c=window.URL.createObjectURL(r),i=document.createElement("a");i.href=c,i.download=a,i.click(),window.URL.revokeObjectURL(c)}}catch(k){var Z,y;console.log(k),f.Am.error((null===(Z=k.response)||void 0===Z||null===(y=Z.data)||void 0===y?void 0:y.message)||"Failed to fetch allocation details")}})(o)}))},sx:{float:"right"},children:"Export to Excel"})})]})}),A&&(0,y.jsx)(p.Z,{open:I,handleClose:()=>{C(!1),N(null)},itemId:A._id,itemName:A.deliveryOrderId.doNumber,onConfirm:(e,o)=>{console.log(`Cancelled item with ID: ${e} for reason: ${o}`),(0,m.IB)(e,{cancelReason:o}).then((()=>{f.Am.success("Successfully cancelled "),b()})).catch((e=>{var o,t;console.log(e),f.Am.error((null===(o=e.response)||void 0===o||null===(t=o.data)||void 0===t?void 0:t.message)||"Failed to cancel the item")}))},formHeading:"cancel"}),(0,y.jsx)(r.Z,{data:S,header:k,isShowSerialNo:!0,isShowAction:!0,actions:["cancel","re-allocate"],onActionChange:e=>{console.log(e),"cancel"==e.action?(console.log(e.data._id),N(e.data),C(!0)):"re-allocate"==e.action?(0,m.Tj)(e.data._id).then((()=>{f.Am.success("Successfully cancelled "),b()})).catch((e=>{var o,t;f.Am.error((null===(o=e.response)||void 0===o||null===(t=o.data)||void 0===t?void 0:t.message)||"Failed to reallocate the item")})):N(),a(o)},refreshData:b})]})}var C=t(1113),A=t(3497);function N(e){let{buttonClick:o,partyId:t}=e;return(0,y.jsx)(A.Z,{children:(0,y.jsxs)(l.Z,{direction:"row",sx:{justifyContent:"space-between",alignItems:"center"},children:[(0,y.jsx)(C.Z,{variant:"h3",color:"secondary.main",children:"Allocated DO Bookings"}),!1]})})}function S(){const[e,o]=(0,n.useState)([]),[t,r]=(0,n.useState)(g()());let{partyId:c}=(0,a.UO)();const i=async function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t.format("DD/MM/YYYY");try{let t={status:"allocated",date:n};e&&(t.partyId=e);const a=await(0,m.Pw)(t);o(a)}catch(a){console.log(a)}};return(0,n.useEffect)((()=>{i(c)}),[t]),(0,y.jsxs)(l.Z,{direction:"column",gap:2,children:[(0,y.jsx)(N,{partyId:c}),(0,y.jsx)(I,{selectedDate:t,setSelectedDate:r,partyId:c,data:e,updateData:i})]})}},5713:function(e,o,t){var n=t(7313),a=t(4469),l=t(3604),r=t(6467),c=t(1113),i=t(4631),s=t(4117),d=t(1095),u=t(6417);o.Z=e=>{let{open:o,handleClose:t,itemId:h,itemName:f,onConfirm:m,formHeading:p="cancel"}=e;const[x,v]=(0,n.useState)("");return(0,u.jsxs)(a.Z,{open:o,onClose:t,children:[(0,u.jsxs)(l.Z,{children:[p," Item"]}),(0,u.jsxs)(r.Z,{children:[(0,u.jsxs)(c.Z,{children:["   Are you sure you want to ",p," the order for ",(0,u.jsx)("strong",{children:f}),"?"]}),(0,u.jsx)(i.Z,{autoFocus:!0,margin:"dense",label:" Reason",type:"text",fullWidth:!0,variant:"outlined",value:x,onChange:e=>v(e.target.value)})]}),(0,u.jsxs)(s.Z,{children:[(0,u.jsx)(d.Z,{onClick:t,color:"primary",children:"back"}),(0,u.jsxs)(d.Z,{onClick:()=>{""!==x.trim()?(m(h,x),t()):alert("Please provide a reason for cancellation.")},color:"error",children:["Confirm ",p]})]})]})}},3604:function(e,o,t){var n=t(7462),a=t(3366),l=t(7313),r=t(4146),c=t(1921),i=t(1113),s=t(7592),d=t(1033),u=t(3174),h=t(3909),f=t(6417);const m=["className","id"],p=(0,s.ZP)(i.Z,{name:"MuiDialogTitle",slot:"Root",overridesResolver:(e,o)=>o.root})({padding:"16px 24px",flex:"0 0 auto"}),x=l.forwardRef((function(e,o){const t=(0,d.i)({props:e,name:"MuiDialogTitle"}),{className:i,id:s}=t,x=(0,a.Z)(t,m),v=t,j=(e=>{const{classes:o}=e;return(0,c.Z)({root:["root"]},u.a,o)})(v),{titleId:Z=s}=l.useContext(h.Z);return(0,f.jsx)(p,(0,n.Z)({component:"h2",className:(0,r.Z)(j.root,i),ownerState:v,ref:o,variant:"h6",id:null!=s?s:Z},x))}));o.Z=x}}]);