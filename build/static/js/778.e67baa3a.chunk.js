"use strict";(self.webpackChunkberry_free_material_react_cra=self.webpackChunkberry_free_material_react_cra||[]).push([[778],{9848:function(t,n,r){r.d(n,{Z:function(){return k}});var e=r(7313),o=r(7592),a=r(7551),i=r(9601),c=r(1405),s=r(5954),u=r(8210),l=r(8790),d=r(4481),p=r(9916),x=r(712),h=r(7474),g=r(7131),f=r(6417);const y=(0,o.ZP)((t=>(0,f.jsx)(i.Z,{elevation:0,anchorOrigin:{vertical:"bottom",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"left"},...t})))((t=>{let{theme:n}=t;return{"& .MuiPaper-root":{borderRadius:6,marginTop:n.spacing(1),minWidth:130,color:"light"===n.palette.mode?"rgb(55, 65, 81)":n.palette.grey[300],boxShadow:"rgb(255, 255, 255) 0px 0px 0px 0px, rgba(0, 0, 0, 0.05) 0px 0px 0px 1px, rgba(0, 0, 0, 0.1) 0px 10px 15px -3px, rgba(0, 0, 0, 0.05) 0px 4px 6px -2px","& .MuiMenu-list":{padding:"4px 0"},"& .MuiMenuItem-root":{"& .MuiSvgIcon-root":{fontSize:18,color:n.palette.text.secondary,marginRight:n.spacing(1.5)},"&:active":{backgroundColor:(0,a.Fq)(n.palette.primary.main,n.palette.action.selectedOpacity)}}}}}));function k(t){let{data:n,actions:r=["Edit","Delete"],onActionChange:o}=t;const[a,i]=e.useState(null),k=Boolean(a),j=t=>{i(null),o&&o({action:t,data:n})};return(0,f.jsxs)("div",{children:[(0,f.jsx)(g.Z,{variant:"contained",onClick:t=>{i(t.currentTarget)},children:(0,f.jsx)(u.Z,{})}),(0,f.jsx)(y,{id:"demo-customized-menu",MenuListProps:{"aria-labelledby":"demo-customized-button"},anchorEl:a,open:k,onClose:j,children:r.map(((t,n)=>"ADD TO QUEUE"==t.toUpperCase()?(0,f.jsxs)(c.Z,{onClick:()=>j(t),sx:{color:"green","&:hover":{backgroundColor:"rgba(72, 113, 247, 0.1)"}},children:[(0,f.jsx)(l.Z,{style:{color:"green"}}),"Add To Queue"]},n):"ADDBOOKING"==t.toUpperCase()?(0,f.jsxs)(c.Z,{onClick:()=>j(t),sx:{color:"green","&:hover":{backgroundColor:"rgba(72, 113, 247, 0.1)"}},children:[(0,f.jsx)(l.Z,{style:{color:"green"}}),"Add TO BOOKING"]},n):"EDIT"==t.toUpperCase()?(0,f.jsxs)(c.Z,{onClick:()=>j(t),children:[(0,f.jsx)(s.Z,{}),"Edit"]},n):"DELETE"==t.toUpperCase()?(0,f.jsxs)(c.Z,{onClick:()=>j(t),sx:{color:"red","&:hover":{backgroundColor:"rgba(255, 0, 0, 0.1)"}},children:[(0,f.jsx)(d.Z,{style:{color:"red"}}),"Delete"]},n):"VIEW"==t.toUpperCase()?(0,f.jsxs)(c.Z,{onClick:()=>j(t),children:[(0,f.jsx)(p.Z,{}),"View"]},n):"CANCEL"==t.toUpperCase()?(0,f.jsxs)(c.Z,{sx:{color:"red"},onClick:()=>j(t),children:[(0,f.jsx)(x.Z,{color:"primary",style:{color:"red"}}),"Cancel"]},n):(0,f.jsxs)(c.Z,{onClick:()=>j(t),children:[(0,f.jsx)(h.Z,{}),t]},n)))})]})}},5842:function(t,n,r){var e=r(7313),o=r(301),a=r(1095),i=r(4469),c=r(5908),s=r(9289),u=r(7131),l=r(1113),d=r(9536),p=r(501),x=r(9019),h=r(1198),g=r(1322),f=r(1387),y=r(6417);const k=e.forwardRef((function(t,n){return(0,y.jsx)(o.Z,{direction:"up",ref:n,...t})}));n.Z=t=>{let{open:n,close:r,doId:o}=t;const[j,m]=e.useState({}),Z=()=>{r()},v=t=>{(0,g.ut)(t).then((t=>{m(t)})).catch((t=>{var n,r;console.error(t),f.Am.error((null===(n=t.response)||void 0===n||null===(r=n.data)||void 0===r?void 0:r.message)||"Error fetching allocation details")}))},w=(t,n)=>{(0,g.jK)({status:n,allocId:t}).then((()=>{f.Am.success("Status updated successfully"),v({doBookingId:o})})).catch((t=>{var n,r;console.error(t),f.Am.error((null===(n=t.response)||void 0===n||null===(r=n.data)||void 0===r?void 0:r.message)||"Error updating status")}))};(0,e.useEffect)((()=>{o&&v({doBookingId:o})}),[o]);return(0,y.jsxs)(i.Z,{fullWidth:!0,maxWidth:"md",open:n,onClose:Z,TransitionComponent:k,children:[(0,y.jsx)(c.Z,{sx:{position:"relative"},children:(0,y.jsxs)(s.Z,{children:[(0,y.jsx)(u.Z,{edge:"start",color:"inherit",onClick:Z,"aria-label":"close",children:(0,y.jsx)(h.Z,{})}),(0,y.jsx)(l.Z,{sx:{ml:2,flex:1,color:"white"},variant:"h3",component:"div",children:"Allocated Truck Details"}),(0,y.jsx)(a.Z,{autoFocus:!0,color:"inherit",onClick:Z,children:"Close"})]})}),(null===j||void 0===j?void 0:j.truckBookingId)&&(0,y.jsxs)(d.Z,{p:2,children:[(0,y.jsxs)(p.Z,{variant:"outlined",sx:{p:2,mb:2},children:[(0,y.jsx)(l.Z,{variant:"h6",gutterBottom:!0,children:"Truck Info"}),(0,y.jsxs)(x.ZP,{container:!0,spacing:2,children:[(0,y.jsxs)(x.ZP,{item:!0,xs:12,sm:6,children:[(0,y.jsxs)(l.Z,{children:[(0,y.jsx)("strong",{children:"Name:"})," ",j.truckBookingId.truck.name]}),(0,y.jsxs)(l.Z,{children:[(0,y.jsx)("strong",{children:"Reg. No.:"})," ",j.truckBookingId.truck.registrationNumber]})]}),(0,y.jsxs)(x.ZP,{item:!0,xs:12,sm:6,children:[(0,y.jsxs)(l.Z,{children:[(0,y.jsx)("strong",{children:"Category:"})," ",j.truckBookingId.truck.category]}),(0,y.jsxs)(l.Z,{children:[(0,y.jsx)("strong",{children:"Type:"})," ",j.truckBookingId.truck.truckType," FT"]})]}),(0,y.jsx)(x.ZP,{item:!0,xs:12,children:(0,y.jsxs)(l.Z,{children:[(0,y.jsx)("strong",{children:"Allocated On:"})," ",(b=j.allocatedOn,new Date(b).toLocaleString())]})})]})]}),(0,y.jsxs)(p.Z,{variant:"outlined",sx:{p:2,mb:2},children:[(0,y.jsx)(l.Z,{variant:"h6",gutterBottom:!0,children:"Company Info"}),(0,y.jsxs)(l.Z,{children:[(0,y.jsx)("strong",{children:"Company:"})," ",j.truckBookingId.truck.companyId.name]}),(0,y.jsxs)(l.Z,{children:[(0,y.jsx)("strong",{children:"Contact:"})," ",j.truckBookingId.truck.companyId.contactNumber]})]}),(0,y.jsxs)(p.Z,{variant:"outlined",sx:{p:2},children:[(0,y.jsx)(l.Z,{variant:"h6",gutterBottom:!0,children:"Driver Info & Status"}),(0,y.jsxs)(x.ZP,{container:!0,spacing:2,alignItems:"center",children:[(0,y.jsxs)(x.ZP,{item:!0,xs:12,sm:6,children:[(0,y.jsxs)(l.Z,{children:[(0,y.jsx)("strong",{children:"Driver:"})," ",j.truckBookingId.truck.driverId.name]}),(0,y.jsxs)(l.Z,{children:[(0,y.jsx)("strong",{children:"Contact:"})," ",j.truckBookingId.truck.driverId.contactNumber]})]}),(0,y.jsxs)(x.ZP,{item:!0,xs:12,sm:6,children:[(0,y.jsxs)(l.Z,{children:[(0,y.jsx)("strong",{children:"Status:"})," ",j.status]}),(0,y.jsx)(d.Z,{mt:1,sx:{display:"none"},children:(t=>{switch(t.status){case"allocated":return(0,y.jsx)(a.Z,{variant:"contained",color:"info",onClick:()=>w(t._id,"ongoing"),disabled:!0,children:"Move to Live"});case"ongoing":return(0,y.jsx)(a.Z,{variant:"contained",color:"warning",onClick:()=>w(t._id,"done"),disabled:!0,children:"Move to Done"});case"expired":return(0,y.jsx)(a.Z,{variant:"outlined",color:"error",disabled:!0,children:"Expired"});default:return null}})(j)})]})]})]})]})]});var b}},6167:function(t,n,r){var e=r(7313),o=r(301),a=r(9860),i=r(5300),c=r(4469),s=r(5908),u=r(9289),l=r(7131),d=r(1113),p=r(1095),x=r(6467),h=r(9536),g=r(8310),f=r(7216),y=r(9019),k=r(2832),j=r(2247),m=r(1198),Z=r(1387),v=r(1322),w=r(658),b=r.n(w),C=r(6417);const I=e.forwardRef((function(t,n){return(0,C.jsx)(o.Z,{direction:"up",ref:n,...t})}));n.Z=t=>{let{open:n,close:r,date:o,doId:w,type:B}=t;const[A,D]=e.useState(n),[T,E]=e.useState([]),P=(0,a.Z)(),S=(0,i.Z)(P.breakpoints.down("sm")),O=()=>{D(!1),r()};return(0,e.useEffect)((()=>{B&&o&&(0,v.VW)({status:"inqueue",type:B,date:o}).then((t=>E(t))).catch(console.error)}),[]),(0,C.jsxs)(c.Z,{fullWidth:!0,maxWidth:"md",open:A,onClose:O,TransitionComponent:I,children:[(0,C.jsx)(s.Z,{sx:{position:"relative"},children:(0,C.jsxs)(u.Z,{children:[(0,C.jsx)(l.Z,{edge:"start",color:"inherit",onClick:O,children:(0,C.jsx)(m.Z,{})}),(0,C.jsx)(d.Z,{sx:{ml:2,flex:1,color:"white"},variant:"h3",children:"Truck Allocation"}),(0,C.jsx)(p.Z,{color:"inherit",onClick:O,children:"Close"})]})}),(0,C.jsx)(x.Z,{dividers:!0,children:0===T.length?(0,C.jsx)(h.Z,{display:"flex",justifyContent:"center",py:4,children:(0,C.jsx)(d.Z,{variant:"subtitle1",color:"text.secondary",children:"No trucks in queue for the selected date and type."})}):(0,C.jsx)(g.Z,{children:T.map(((t,n)=>(0,C.jsxs)(e.Fragment,{children:[(0,C.jsx)(f.ZP,{disableGutters:!0,sx:{bgcolor:n%2===0?"background.default":"grey.100",borderRadius:1,px:2,py:1},children:(0,C.jsx)(h.Z,{width:"100%",children:(0,C.jsxs)(y.ZP,{container:!0,spacing:2,alignItems:"center",children:[(0,C.jsx)(y.ZP,{item:!0,xs:12,sm:1,children:(0,C.jsxs)(h.Z,{sx:{display:"inline-block",bgcolor:"primary.dark",color:"primary.contrastText",px:1.2,py:.5,borderRadius:1,fontWeight:600,fontSize:"0.95rem"},children:["#",n+1]})}),(0,C.jsx)(y.ZP,{item:!0,xs:12,sm:3,children:(0,C.jsxs)(k.Z,{spacing:.5,children:[(0,C.jsx)(d.Z,{variant:"body1",fontWeight:500,children:t.truck.name}),(0,C.jsx)(d.Z,{variant:"body2",color:"text.secondary",children:t.truck.registrationNumber})]})}),(0,C.jsx)(y.ZP,{item:!0,xs:9,sm:3,children:(0,C.jsxs)(k.Z,{spacing:.5,children:[(0,C.jsx)(d.Z,{variant:"body1",children:t.truck.companyId.name}),(0,C.jsx)(d.Z,{variant:"body2",color:"text.secondary",children:t.truck.companyId.contactNumber})]})}),(0,C.jsx)(y.ZP,{item:!0,xs:3,sm:3,children:(0,C.jsxs)(k.Z,{spacing:.5,children:[(0,C.jsx)(d.Z,{variant:"body1",children:t.truck.category}),(0,C.jsxs)(d.Z,{variant:"body2",color:"text.secondary",children:[t.truck.truckType," FT"]}),(0,C.jsx)(d.Z,{variant:"body2",color:"text.secondary",children:b()(t.createdAt).format("DD/MM/YYYY hh:mm:ss A")})]})}),(0,C.jsx)(y.ZP,{item:!0,xs:12,sm:2,children:(0,C.jsx)(p.Z,{fullWidth:S,variant:"contained",color:"primary",onClick:()=>{return n=t._id,void(o&&w?(0,v.T7)({doBookingId:w,doDate:o,truckBookingId:n}).then((()=>{Z.Am.success("DO allocation successful!"),O()})).catch((t=>{var n,r;Z.Am.error((null===t||void 0===t||null===(n=t.response)||void 0===n||null===(r=n.data)||void 0===r?void 0:r.message)||"Allocation failed"),console.error(t)})):Z.Am.error("Date or DO ID missing"));var n},children:"Allocate"})})]})})}),(0,C.jsx)(j.Z,{sx:{my:1}})]},t._id)))})})]})}},1322:function(t,n,r){r.d(n,{$K:function(){return d},$g:function(){return E},AW:function(){return D},Au:function(){return l},BU:function(){return w},CE:function(){return j},Dx:function(){return S},ES:function(){return X},Et:function(){return _},GB:function(){return x},Gu:function(){return s},IB:function(){return z},Jq:function(){return Y},Jr:function(){return Z},K3:function(){return p},KI:function(){return F},M$:function(){return U},Mg:function(){return V},Pe:function(){return g},Pw:function(){return W},Q1:function(){return y},RY:function(){return P},S1:function(){return L},T5:function(){return k},T7:function(){return C},Tj:function(){return K},VW:function(){return v},Wo:function(){return q},X2:function(){return Q},X6:function(){return m},Xy:function(){return O},a2:function(){return f},aZ:function(){return u},cW:function(){return $},cn:function(){return B},h8:function(){return T},jK:function(){return I},ji:function(){return i},kR:function(){return M},kl:function(){return h},lQ:function(){return o},oR:function(){return a},r7:function(){return c},ss:function(){return N},ut:function(){return b},uz:function(){return A},xF:function(){return R},zE:function(){return G}});const e=r(5662).Z.create({baseURL:"https://apis.fleetq.live/api/",headers:{"Content-Type":"application/json"}});async function o(t){return(await e.post("company",t)).data}async function a(t){return(await e.delete("company/"+t,t)).data}async function i(t,n){return(await e.patch("company/"+t,n)).data}async function c(t){return(await e.post("company/getAllCompany",t)).data}async function s(t){return(await e.post("truck",t)).data}async function u(t){return(await e.post("truck/getAllTruck",t)).data}async function l(t){return(await e.post("truck/updateTruckStatus",t)).data}async function d(t){return(await e.delete("truck/"+t,t)).data}async function p(t,n){return(await e.patch("truck/"+t,n)).data}async function x(t){return(await e.post("truck/updateTruckBookingStatus",t)).data}async function h(t){return(await e.post("truck/getAllTruckBookings",t)).data}async function g(t){return(await e.post("truck/addTruckToBooking",t)).data}async function f(t){return(await e.post("party/getAllParty",t)).data}async function y(t){return(await e.post("party",t)).data}async function k(t){return(await e.delete(`party/${t}`)).data}async function j(t,n){return(await e.post(`party/${t}`,n)).data}async function m(t){return(await e.put(`party/updateStatus/${t}`)).data}async function Z(t){return(await e.post("truck/getAllTruckBookings",{status:t.status})).data}async function v(t){return(await e.post("truck/getInQueueTrucks",t)).data}async function w(t){return(await e.post("truck/getTruckQueue",t)).data}async function b(t){return(await e.post("allocation/getAllocationDetails",t)).data}async function C(t){return(await e.post("allocation",t)).data}async function I(t){return(await e.post("allocation/changeAllocationStatus",t)).data}async function B(t){return(await e.post("user",t)).data}async function A(t){return(await e.post("user/editUser",t)).data}async function D(t){return(await e.get("user/getAllUsers"+(t?`?companyId=${t}`:""))).data}async function T(t){return(await e.delete(`user/${t}`)).data}async function E(t){const n=await e.post("user/login",t);return console.log(n),n.data}async function P(t){return(await e.post("location/getAllLocation",t)).data}async function S(t){return(await e.post("location",t)).data}async function O(t){return(await e.post("doBooking/getAllDO",t)).data}async function W(t){return(await e.post("allocation/get-All-AllocationDetails",t)).data}async function $(t){return(await e.post("doBooking",t)).data}async function M(t){return(await e.post("doBooking/uploadDO",t)).data}async function U(t,n){try{return(await e.put(`doBooking/updateDO/${t}`,n)).data}catch(r){throw console.error("Error updating delivery order:",r),r}}async function _(t,n){try{return(await e.post(`doBooking/cancelDO/${t}`,n)).data}catch(r){throw console.error("Error updating delivery order:",r),r}}async function N(t,n){try{return(await e.post(`doBooking/cancelDOBooking/${t}`,n)).data}catch(r){throw console.error("Error cancelling Do booking:",r),r}}async function R(t){try{return(await e.post(`doBooking/reopen-do-booking/${t}`)).data}catch(n){throw console.error("Error cancelling Do booking:",n),n}}async function z(t,n){try{return(await e.post(`allocation/cancel-allocated-booking/${t}`,n)).data}catch(r){throw console.error("Error cancelling Do booking:",r),r}}async function K(t){try{return(await e.post(`allocation/re-allocate-booking/${t}`)).data}catch(n){throw console.error("Error cancelling Do booking:",n),n}}async function L(t){return(await e.post("doBooking/getAllDeliveryOrders",t)).data}async function q(t){return(await e.delete("doBooking",t)).data}async function F(t){return(await e.delete("doBooking/deleteDeliveryOrder/"+t)).data}async function Q(t){return(await e.post("driver",t)).data}async function G(t){return(await e.post("driver/getAllDrivers",t)).data}async function Y(t){return(await e.post("driver/getCompanyDrivers",t)).data}async function V(t){return(await e.delete("driver/"+t,t)).data}async function X(t,n){return(await e.patch("driver/"+t,n)).data}e.interceptors.request.use((async t=>{const n=localStorage.getItem("token");return n?t.headers.Authorization="Bearer "+n:console.warn("Token not found in localStorage"),t}),(t=>Promise.reject(t))),e.interceptors.response.use((t=>t),(t=>(t.response&&401===t.response.status&&(console.log("Unauthorized, logging out..."),localStorage.clear(),window.location.href="/login"),Promise.reject(t))))}}]);