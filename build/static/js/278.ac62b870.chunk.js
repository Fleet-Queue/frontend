"use strict";(self.webpackChunkberry_free_material_react_cra=self.webpackChunkberry_free_material_react_cra||[]).push([[278],{2186:function(e,r,n){n.d(r,{Z:function(){return h}});var a=n(3365),s=n(4469),o=n(3604),t=n(2832),l=n(1113),i=n(7313),d=n(1766),c=n(6417);const u=i.forwardRef((function(e,r){return(0,c.jsx)(a.Z,{ref:r,...e})}));function h(e){let{title:r,children:n,open:a,onClose:i,...h}=e;return(0,c.jsxs)(s.Z,{...h,open:a,TransitionComponent:u,children:[(0,c.jsx)(o.Z,{children:(0,c.jsxs)(t.Z,{direction:"row",sx:{justifyContent:"space-between",alignItems:"center"},children:[(0,c.jsx)(l.Z,{variant:"h2",color:"primary.main",children:r}),(0,c.jsx)(d.Z,{sx:{cursor:"pointer"},onClick:i})]})}),n]})}},8999:function(e,r,n){n.d(r,{Z:function(){return f}});var a=n(7313),s=n(3497),o=n(1629),t=n(6835),l=n(3477),i=n(4076),d=n(7478),c=n(3467),u=n(1095),h=n(9848),m=n(6167),p=n(5842),x=n(6417);function f(e){let{data:r,header:n,isShowSerialNo:f=!1,isShowAction:j=!1,actions:Z=["Edit","Delete"],onActionChange:v,onClickAction:g,refreshData:y}=e;const[C,A]=(0,a.useState)(null),[w,S]=(0,a.useState)(null),[I,b]=(0,a.useState)(null),[N,E]=(0,a.useState)(null),[k,U]=(0,a.useState)(!1);return(0,x.jsxs)(s.Z,{children:[(0,x.jsx)(o.Z,{children:(0,x.jsxs)(t.Z,{children:[(0,x.jsx)(l.Z,{children:(0,x.jsxs)(i.Z,{children:[f&&(0,x.jsx)(d.Z,{sx:{color:"primary.main"},children:"SLNO"}),n.map(((e,r)=>(0,x.jsx)(d.Z,{sx:{color:"primary.main"},children:e},r))),j&&(0,x.jsx)(d.Z,{sx:{color:"primary.main"},children:"Action"})]})}),(0,x.jsx)(c.Z,{children:r.map(((e,r)=>(0,x.jsxs)(i.Z,{onClick:()=>(e=>{g&&g(e)})(e._id),children:[f&&(0,x.jsx)(d.Z,{children:r+1}),n.map(((r,n)=>{if("IMAGE"===r.toUpperCase())return(0,x.jsx)(d.Z,{children:(0,x.jsx)("img",{style:{height:"100px"},src:`${e[`${r}`]}`,alt:"img"})},n);if("allocated"!=e.status&&"ALLOCATION"===r.toUpperCase())return console.log("dfffffffffffffffffffffffffffffffffffff"),console.log(e),(0,x.jsx)(d.Z,{children:(0,x.jsx)(u.Z,{variant:"contained",onClick:()=>(e=>{console.log("select alloccccccccccccccccccccccc"),console.log(e),console.log("heeeeeeeeeeeeeeeeeeeeeeedataaaaaaaaaaaaaaaa"),A(e.truckType),S(e.date),E(e.doId),console.log(e.truckType),U(!0)})({doId:e._id,truckType:e.truckType,date:e["available from"]}),children:"Allocate"})},n);if("allocated"==e.status&&"ALLOCATION"===r.toUpperCase())return(0,x.jsx)(d.Z,{children:(0,x.jsx)(u.Z,{variant:"contained",onClick:()=>{return r=e._id,b(r),void U(!0);var r},children:"View Allocation"})},n);if("VIEW DO"===r.toUpperCase()){const r=e["view DO"]||e.deliveryOrderId&&e.deliveryOrderId.doLink;return r?(0,x.jsx)(d.Z,{children:(0,x.jsx)(u.Z,{variant:"contained",onClick:()=>window.open(r,"_blank"),children:"View File"})},n):(0,x.jsx)(d.Z,{children:(0,x.jsx)(u.Z,{variant:"contained",disabled:!0,children:"No File"})},n)}return"isHighRangeArea"!=e.status&&"ISHIGHRANGEAREA"===r.toUpperCase()?(0,x.jsx)(d.Z,{children:e[`${r}`]?"Yes":"No"},n):"STATUS"===r.toUpperCase()?(0,x.jsx)(d.Z,{children:e[`${r}`]?"Active":"Inactive"},n):(0,x.jsx)(d.Z,{children:e[`${r}`]},n)})),j&&(0,x.jsx)(d.Z,{children:(0,x.jsx)(h.Z,{data:e,onActionChange:e=>{v(e)},actions:Z})})]},r)))})]})}),C&&(0,x.jsx)(m.Z,{open:k,close:()=>{A(null),console.log("heeeeeeeeeeeeeeeeeeeeeeeey"),y(),U(!1)},doId:N,date:w,type:C}),I&&(0,x.jsx)(p.Z,{open:k,close:()=>{b(null),y(),U(!1)},doId:I})]})}},5266:function(e,r,n){n.d(r,{h:function(){return o}});var a=n(6031),s=n.n(a);const o=(e,r,n)=>e.map((e=>s().mapKeys(e,((e,a)=>{for(let s=0;s<n.length;s++)if(a===r[s])return n[s];return a}))))},2278:function(e,r,n){n.r(r),n.d(r,{default:function(){return T}});var a=n(7313),s=n(9536),o=n(4713),t=n(4631),l=n(4469),i=n(3604),d=n(6467),c=n(4117),u=n(1095),h=n(8999),m=n(5266),p=n(7825),x=n(2832),f=n(1113),j=n(1550),Z=n(3306),v=n(8797),g=n(1405),y=n(5480),C=n(5627),A=n(1387),w=n(2186),S=n(1322),I=n(6417);function b(e){let{getData:r,open:n,onClose:s,isEdit:o=!1,data:l={}}=e;const[i,d]=(0,a.useState)([]),{control:c,handleSubmit:h,formState:{errors:m},reset:b}=(0,C.cI)({defaultValues:o?{name:l.Name||"",userName:l["User Name"]||"",address:l.Address||"",email:l.Email||"",phone:l["Contact Number"]||"",password:"",companyId:l.companyId||""}:{name:"",userName:"",address:"",email:"",phone:"",password:"",companyId:""}});(0,a.useEffect)((()=>{n&&((0,S.r7)().then((e=>{console.log("heyyy"),d(e)})).catch((e=>{console.error(e),A.Am.error("Failed to fetch companies")})),console.log(l))}),[n]);const N=()=>{s(),b()};return(0,I.jsx)(w.Z,{open:n,fullWidth:!0,onClose:N,title:(o?"Edit":"Add")+" User",children:(0,I.jsx)("form",{onSubmit:h((e=>{const n={...e,role:"company"};(o?(0,S.uz)({userId:l._id,...n}):(0,S.cn)(n)).then((()=>{A.Am.success(`User ${o?"updated":"added"} successfully`),r(),N()})).catch((e=>{var r,n;console.error(e),A.Am.error((null===(r=e.response)||void 0===r||null===(n=r.data)||void 0===n?void 0:n.message)||"Something went wrong")}))})),children:(0,I.jsx)(p.Z,{children:(0,I.jsxs)(x.Z,{direction:"column",sx:{p:2},spacing:2,children:[(0,I.jsx)(f.Z,{variant:"h5",children:"Name"}),(0,I.jsx)(C.Qr,{name:"name",control:c,rules:{required:"Name is required"},render:e=>{var r;let{field:n}=e;return(0,I.jsx)(t.Z,{...n,placeholder:"Enter Name",error:!!m.name,helperText:null===(r=m.name)||void 0===r?void 0:r.message})}}),(0,I.jsx)(f.Z,{variant:"h5",children:"User Name"}),(0,I.jsx)(C.Qr,{name:"userName",control:c,rules:{required:"Username is required"},render:e=>{var r;let{field:n}=e;return(0,I.jsx)(t.Z,{...n,placeholder:"Enter Username",error:!!m.userName,helperText:null===(r=m.userName)||void 0===r?void 0:r.message})}}),(0,I.jsx)(f.Z,{variant:"h5",children:"Address"}),(0,I.jsx)(C.Qr,{name:"address",control:c,rules:{required:"Address is required"},render:e=>{var r;let{field:n}=e;return(0,I.jsx)(t.Z,{...n,placeholder:"Enter Address",error:!!m.address,helperText:null===(r=m.address)||void 0===r?void 0:r.message})}}),(0,I.jsx)(f.Z,{variant:"h5",children:"Email"}),(0,I.jsx)(C.Qr,{name:"email",control:c,rules:{required:"Email is required"},render:e=>{var r;let{field:n}=e;return(0,I.jsx)(t.Z,{...n,placeholder:"Enter Email",error:!!m.email,helperText:null===(r=m.email)||void 0===r?void 0:r.message})}}),(0,I.jsx)(f.Z,{variant:"h5",children:"Phone"}),(0,I.jsx)(C.Qr,{name:"phone",control:c,rules:{required:"Phone number is required",pattern:{value:/^[0-9]{10}$/,message:"Phone number must be exactly 10 digits"}},render:e=>{var r;let{field:n}=e;return(0,I.jsx)(t.Z,{...n,placeholder:"Enter Phone",error:!!m.phone,helperText:null===(r=m.phone)||void 0===r?void 0:r.message})}}),(0,I.jsx)(f.Z,{variant:"h5",children:"Password"}),(0,I.jsx)(C.Qr,{name:"password",control:c,rules:{required:!o&&"Password is required"},render:e=>{var r;let{field:n}=e;return(0,I.jsx)(t.Z,{...n,type:"password",placeholder:"Enter Password",error:!!m.password,helperText:null===(r=m.password)||void 0===r?void 0:r.message})}}),(0,I.jsxs)(j.Z,{fullWidth:!0,error:!!m.companyId,children:[(0,I.jsx)(Z.Z,{id:"companyId-label",children:"Company"}),(0,I.jsx)(C.Qr,{name:"companyId",control:c,rules:{required:"Company is required"},render:e=>{let{field:r}=e;return(0,I.jsx)(v.Z,{...r,labelId:"companyId-label",label:"Company",showSearch:!0,MenuProps:{PaperProps:{style:{maxHeight:300}}},children:i.map((e=>(0,I.jsx)(g.Z,{value:e._id,children:e.name},e._id)))})}}),m.companyId&&(0,I.jsx)(y.Z,{children:m.companyId.message})]}),(0,I.jsx)(u.Z,{variant:"contained",type:"submit",sx:{width:"150px"},children:o?"Update":"Create"})]})})})})}const N=["Name","User Name","Company Name","Contact Number","Address","Email","Role","Status"];function E(e){let{data:r,updateData:n,companyData:p}=e;const[x,f]=(0,a.useState)(!1),[j,Z]=(0,a.useState)(),[v,g]=(0,a.useState)(null),[y,C]=(0,a.useState)(!1),[w,E]=(0,a.useState)(null),k=(0,m.h)(r,["name","userName","company","phone","address","email","role","status"],N);return(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(s.Z,{sx:{mb:2},children:(0,I.jsx)(o.Z,{options:p||[],getOptionLabel:e=>e.name||"",value:v,onChange:(e,r)=>{g(r),n(null===r||void 0===r?void 0:r._id)},renderInput:e=>(0,I.jsx)(t.Z,{...e,label:"Search Company",variant:"outlined",size:"small",fullWidth:!0})})}),x&&(0,I.jsx)(b,{getData:n,open:x,onClose:()=>{f(!1)},data:j,isEdit:!0}),(0,I.jsxs)(l.Z,{open:y,onClose:()=>C(!1),children:[(0,I.jsx)(i.Z,{children:"Confirm Delete"}),(0,I.jsxs)(d.Z,{children:["Are you sure you want to delete user `",null===w||void 0===w?void 0:w.Name,"`?"]}),(0,I.jsxs)(c.Z,{children:[(0,I.jsx)(u.Z,{onClick:()=>C(!1),children:"Cancel"}),(0,I.jsx)(u.Z,{onClick:async()=>{try{await(0,S.h8)(w._id),A.Am.success("User deleted successfully"),n(),C(!1),E(null)}catch(a){var e,r;console.error(a),A.Am.error((null===(e=a.response)||void 0===e||null===(r=e.data)||void 0===r?void 0:r.message)||"Error deleting user")}},color:"error",children:"Delete"})]})]}),(0,I.jsx)(h.Z,{data:k,header:N,isShowSerialNo:!0,isShowAction:!0,actions:["Edit","delete"],onActionChange:async e=>{console.log(e),"delete"==e.action?(console.log(e.data),E(e.data),C(!0)):"Edit"==e.action?(f(!0),console.log(e.data),Z(e.data),console.log("edit company")):Z()}})]})}var k=n(2040),U=n(3497);function _(e){let{buttonClick:r}=e;return(0,I.jsx)(U.Z,{children:(0,I.jsxs)(x.Z,{direction:"row",sx:{justifyContent:"space-between",alignItems:"center"},children:[(0,I.jsx)(f.Z,{variant:"h3",color:"secondary.main",children:"Manage Users"}),(0,I.jsx)(u.Z,{variant:"contained",startIcon:(0,I.jsx)(k.Z,{}),sx:{backgroundColor:"secondary.main"},onClick:r,children:"Add User"})]})})}function T(){const[e,r]=(0,a.useState)(!1),[n,s]=(0,a.useState)([]),o=e=>{(0,S.AW)(e).then((e=>{s(e)})).catch((e=>{console.log(e),A.Am.error(e.response.data.message)}))},[t,l]=(0,a.useState)([]),i=()=>{(0,S.r7)().then((e=>{l(e)})).catch((e=>{console.log(e),A.Am.error(e.response.data.message)}))};return(0,a.useEffect)((()=>{i(),o()}),[]),(0,I.jsxs)(x.Z,{direction:"column",gap:2,children:[(0,I.jsx)(b,{open:e,getData:o,getAllCompanies:i,onClose:()=>{r(!1)}}),(0,I.jsx)(_,{buttonClick:()=>r(!0)}),(0,I.jsx)(E,{data:n,updateData:o,companyData:t})]})}}}]);