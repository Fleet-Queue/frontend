"use strict";(self.webpackChunkberry_free_material_react_cra=self.webpackChunkberry_free_material_react_cra||[]).push([[74],{7713:function(e,t,a){var n=a(421),r=a(7120);const o=(0,n.ZF)({apiKey:"AIzaSyCBwJaecXhomn4kYayf-XMwOVfBZZyvtZ8",authDomain:"container-management-e3afb.firebaseapp.com",projectId:"container-management-e3afb",storageBucket:"container-management-e3afb.appspot.com",messagingSenderId:"355036042666",appId:"1:355036042666:web:d26919044f6afc7be387d3"}),l=(0,r.cF)(o);t.Z=l},9214:function(e,t,a){a.d(t,{Z:function(){return I}});var n=a(7313),r=a(1095),o=a(4469),l=a(4117),s=a(6467),i=a(7762),c=a(3604),d=a(7713),u=a(7131),h=a(4631),m=a(5480),p=a(5627),x=a(1322),f=a(1387),g=a(9176),y=a(1113),j=a(7120),Z=a(8586),b=a(9818),v=a(8372),D=a(2549),S=a(6417);function I(e){const[t,a]=n.useState(!1),[g,I]=n.useState([]),[k,w]=n.useState(null),{register:F,handleSubmit:A,setValue:B,formState:{errors:_}}=(0,p.cI)({defaultValues:{}}),N=()=>{e.onClose(),w(null),I([]),a(!1)};n.useEffect((()=>{a(e.open)}),[e.open]);const M=async(e,t)=>{const a=`${t}-${(0,D.Z)()}`,n=(0,j.iH)(d.Z,`/DoBookings/${a}`),r=(0,j.B0)(n,e);return new Promise(((n,o)=>{r.on("state_changed",(e=>{const t=Math.round(e.bytesTransferred/e.totalBytes*100);w(t)}),(e=>o(e)),(()=>{(0,j.Jt)(r.snapshot.ref).then((r=>{(0,x.kR)({doLink:r,name:t,uniqueName:a,fileName:e.name}).then((()=>{n()})).catch((e=>{o(e)}))}))}))}))};return(0,S.jsx)(n.Fragment,{children:(0,S.jsx)(o.Z,{fullWidth:!0,maxWidth:"sm",open:t,onClose:N,children:(0,S.jsxs)("form",{onSubmit:A((async e=>{const{files:t,name:a}=e;if(t&&0!==t.length){for(let e of t)try{await M(e,a)}catch(o){var n,r;console.log(o),f.Am.error((null===(n=o.response)||void 0===n||null===(r=n.data)||void 0===r?void 0:r.message)||"Failed to upload file");break}N()}else f.Am.error("Please choose at least one file")})),children:[(0,S.jsxs)(c.Z,{children:["Upload DO",(0,S.jsx)(u.Z,{"aria-label":"close",onClick:N,sx:{position:"absolute",right:8,top:8,color:e=>e.palette.grey[500]},children:(0,S.jsx)(Z.Z,{})})]}),(0,S.jsxs)(s.Z,{children:[(0,S.jsx)(i.Z,{children:"Upload Delivery Orders."}),(0,S.jsx)(h.Z,{label:"Name",variant:"outlined",fullWidth:!0,margin:"normal",...F("name",{required:!0}),error:!!_.name,helperText:_.name?"Name is required":""}),(0,S.jsx)("input",{accept:"image/*,.pdf",style:{display:"none"},id:"raised-button-file",type:"file",multiple:!0,onChange:e=>{const t=Array.from(e.target.files);I(t.map((e=>e.name))),B("files",t)}}),(0,S.jsxs)("label",{htmlFor:"raised-button-file",children:[(0,S.jsx)(v.Z,{display:"flex",justifyContent:"center",alignItems:"center",height:150,children:(0,S.jsx)(b.Z,{style:{fontSize:100}})}),(0,S.jsx)(y.Z,{variant:"h6",align:"center",sx:{marginTop:1,marginBottom:1},children:"Upload Files"}),null!==k&&(0,S.jsx)(v.Z,{sx:{width:"100%"},children:(0,S.jsx)(C,{value:k})})]}),g.length>0&&g.map(((e,t)=>(0,S.jsx)(m.Z,{children:e},t)))]}),(0,S.jsxs)(l.Z,{children:[(0,S.jsx)(r.Z,{onClick:N,color:"secondary",variant:"outlined",children:"Cancel"}),(0,S.jsx)(r.Z,{variant:"contained",type:"submit",children:"Submit"})]})]})})})}function C(e){return(0,S.jsxs)(v.Z,{sx:{display:"flex",alignItems:"center"},children:[(0,S.jsx)(v.Z,{sx:{width:"100%",mr:1},children:(0,S.jsx)(g.Z,{variant:"determinate",...e})}),(0,S.jsx)(v.Z,{sx:{minWidth:35},children:(0,S.jsx)(y.Z,{variant:"body2",color:"text.secondary",children:`${Math.round(e.value)}%`})})]})}},9074:function(e,t,a){a.r(t),a.d(t,{default:function(){return Y}});var n=a(7313),r=a(7890),o=a(2832),l=a(8999),s=a(5266),i=a(9536),c=a(1095),d=a(4469),u=a(4117),h=a(6467),m=a(7762),p=a(3604),x=a(1550),f=a(7131),g=a(1198),y=a(4631),j=a(8444),Z=a(3208),b=a(5904),v=a(57),D=a(658),S=a.n(D),I=a(3306),C=a(4256),k=a(1405),w=a(5480),F=a(1113),A=a(5627),B=a(1322),_=a(1387),N=a(6417);function M(e){const[t,a]=n.useState(!1),[r,o]=n.useState([]),[l,s]=n.useState(null),{control:D,handleSubmit:M,reset:O,formState:{errors:q}}=(0,A.cI)({defaultValues:{type:20}}),$=new Date,T=$,E=(0,v.E)($,30),W=new Date(T),U=`${W.getFullYear()}-${String(W.getMonth()+1).padStart(2,"0")}-${String(W.getDate()).padStart(2,"0")}`,V=new Date(E),Y=`${V.getFullYear()}-${String(V.getMonth()+3).padStart(2,"0")}-${String(V.getDate()).padStart(2,"0")}`,z=()=>{e.onClose(),O(),a(!1)};n.useEffect((()=>{(0,B.a2)({companyId:e.data}).then((e=>{console.log(e),o(e)})).catch((e=>{console.log(e),_.Am.error(e)}))}),[e.data]),n.useEffect((()=>{a(e.open)}),[e]);return(0,N.jsx)(n.Fragment,{children:(0,N.jsx)(Z._,{dateAdapter:b.y,children:(0,N.jsx)(d.Z,{fullWidth:!0,maxWidth:"sm",open:t,onClose:z,children:(0,N.jsxs)("form",{onSubmit:M((async t=>{if(!l)return void _.Am.error("Please select a date");if(!e.doId)return void _.Am.error("Delivery order Id missing");const a=S()(l).format("YYYY-MM-DD"),{type:n,rate:r,party:o}=t;console.log({party:o,availableFrom:a,type:n,doId:e.doId,companyId:e.data,rate:r});try{await(0,B.cW)({partyId:o,deliveryOrderId:e.doId,availableFrom:a,truckType:n,rate:r,companyId:e.data}),_.Am.success("Do Created Successfully, now you can allocate truck"),z()}catch(s){console.error("Failed to create DO:",s),_.Am.error("Failed to create DO")}})),children:[(0,N.jsx)(p.Z,{children:"ADD Booking"}),(0,N.jsx)(f.Z,{"aria-label":"close",onClick:z,sx:{position:"absolute",right:8,top:8,color:e=>e.palette.grey[500]},children:(0,N.jsx)(g.Z,{})}),(0,N.jsxs)(h.Z,{children:[(0,N.jsx)(m.Z,{children:"Upload Delivery Order"}),(0,N.jsxs)(i.Z,{noValidate:!0,component:"form",sx:{display:"flex",flexDirection:"column",m:"auto",width:"fit-content"},children:[(0,N.jsxs)(x.Z,{error:Boolean(q.driver),children:[(0,N.jsx)(I.Z,{id:"type-select-label",children:"Party"}),(0,N.jsx)(A.Qr,{name:"party",control:D,render:e=>{let{field:t}=e;return(0,N.jsxs)(C.Z,{...t,labelId:"type-select-label",id:"type-select",label:"party",value:t.value||"",onChange:e=>{t.onChange(e.target.value)},children:[(0,N.jsx)(k.Z,{value:"",children:(0,N.jsx)("em",{children:"None"})}),r.map((e=>(0,N.jsxs)(k.Z,{value:e._id,children:[e.name," Mob: ",e.contactNumber," Address: ",e.address," "]},e._id)))]})},rules:{required:"Party is required"}}),q.party&&(0,N.jsx)(w.Z,{children:q.party.message})]}),(0,N.jsx)(x.Z,{sx:{mt:2,minWidth:120},children:(0,N.jsx)(j.M,{label:"From Date",value:l,onChange:e=>s(e),minDate:S()(U),maxDate:S()(Y),renderInput:e=>(0,N.jsx)(y.Z,{...e})})}),(0,N.jsxs)(x.Z,{error:Boolean(q.type),sx:{mt:2},children:[(0,N.jsx)(I.Z,{id:"type-select-label",children:"Type"}),(0,N.jsx)(A.Qr,{name:"type",control:D,defaultValue:20,render:e=>{let{field:t}=e;return(0,N.jsxs)(C.Z,{...t,labelId:"type-select-label",id:"type-select",label:"Type",onChange:e=>t.onChange(e.target.value),children:[(0,N.jsx)(k.Z,{value:20,children:"20 FT"}),(0,N.jsx)(k.Z,{value:40,children:"40 FT"})]})},rules:{required:"Type is required"}}),q.type&&(0,N.jsx)(w.Z,{children:q.type.message})]}),(0,N.jsx)(F.Z,{variant:"h5",children:"Rate"}),(0,N.jsx)(A.Qr,{name:"rate",control:D,render:e=>{let{field:t}=e;return(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(y.Z,{...t,placeholder:"Enter Rate"}),q.rate&&(0,N.jsx)("span",{style:{color:"#f00"},children:q.rate.message})]})},rules:{required:"Rate is required"}})]})]}),(0,N.jsx)(u.Z,{children:(0,N.jsx)(c.Z,{variant:"contained",type:"submit",children:"ADD Booking"})})]})})})})}var O=a(7120),q=a(7713);const $=["name","View DO","uploadDate","status"];function T(e){let{partyId:t,data:a,updateData:o}=e;const[i,c]=(0,n.useState)(!1),[d,u]=(0,n.useState)({}),h=(0,r.s0)(),m=(0,s.h)(a,["name","link","uploadDate","status"],$),p="admin"===localStorage.getItem("role"),x=async e=>{if(e){const a=(0,O.iH)(q.Z,`/DoBookings/${e}`);try{await(0,O.oq)(a),_.Am.success("File deleted successfully")}catch(t){console.error("Failed to delete file:",t),_.Am.error("Failed to delete file")}}else _.Am.error("File not found:",e)};return(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(M,{open:i,onClose:()=>{c(!1),o(t),h("/doBooking")},isEdit:!0,getBookings:o,data:null===d||void 0===d?void 0:d.companyId,doId:null===d||void 0===d?void 0:d._id}),(0,N.jsx)(l.Z,{data:m,header:$,isShowSerialNo:!0,isShowAction:!0,actions:p?["addBooking","delete"]:["delete"],onActionChange:e=>{console.log(e),"delete"==e.action?(console.log(e.data._id),x(e.data.uniqueName),u(e.data),(0,B.KI)(e.data._id).then((()=>{_.Am.success("Do deleted Successfully"),o(t)})).catch((e=>{console.error(e),_.Am.error(e.response.data.message)}))):"addBooking"==e.action?(u(e.data),console.log(e.data),c(!0),console.log("add to booking"),console.log(e.data._id)):u()}})]})}var E=a(2040),W=a(3497);function U(e){let{buttonClick:t}=e;const a="both"===localStorage.getItem("role")||"forwarder"===localStorage.getItem("role");return(0,N.jsx)(W.Z,{children:(0,N.jsxs)(o.Z,{direction:"row",sx:{justifyContent:"space-between",alignItems:"center"},children:[(0,N.jsx)(F.Z,{variant:"h3",color:"secondary.main",children:"DO Uploads"}),a&&(0,N.jsx)(c.Z,{variant:"contained",startIcon:(0,N.jsx)(E.Z,{}),sx:{backgroundColor:"secondary.main"},onClick:t,children:"Add DO"})]})})}var V=a(9214);function Y(){const[e,t]=(0,n.useState)(!1),[a,l]=(0,n.useState)([]);let{partyId:s}=(0,r.UO)();const i=async e=>{try{let t={status:0};e&&(t.partyId=e);const a=await(0,B.S1)(t);l(a)}catch(t){console.log(t)}};return(0,n.useEffect)((()=>{i(s)}),[]),(0,N.jsxs)(o.Z,{direction:"column",gap:2,children:[(0,N.jsx)(V.Z,{data:s,open:e,getBookings:i,onClose:()=>{t(!1),i(s)}}),(0,N.jsx)(U,{partyId:s,buttonClick:()=>t(!0)}),(0,N.jsx)(T,{partyId:s,data:a,updateData:i})]})}},8586:function(e,t,a){var n=a(1171),r=a(6417);t.Z=(0,n.Z)((0,r.jsx)("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Close")},9818:function(e,t,a){var n=a(1171),r=a(6417);t.Z=(0,n.Z)((0,r.jsx)("path",{d:"M19.35 10.04C18.67 6.59 15.64 4 12 4 9.11 4 6.6 5.64 5.35 8.04 2.34 8.36 0 10.91 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.65-4.96zM14 13v4h-4v-4H7l5-5 5 5h-3z"}),"CloudUpload")},57:function(e,t,a){function n(e){const t=Object.prototype.toString.call(e);return e instanceof Date||"object"===typeof e&&"[object Date]"===t?new e.constructor(+e):"number"===typeof e||"[object Number]"===t||"string"===typeof e||"[object String]"===t?new Date(e):new Date(NaN)}a.d(t,{E:function(){return o}});function r(e,t){return e instanceof Date?new e.constructor(t):new Date(t)}function o(e,t){const a=n(e);return isNaN(t)?r(e,NaN):t?(a.setDate(a.getDate()+t),a):a}}}]);