"use strict";(self.webpackChunkberry_free_material_react_cra=self.webpackChunkberry_free_material_react_cra||[]).push([[278],{2186:function(e,r,n){n.d(r,{Z:function(){return m}});var s=n(3365),a=n(4469),o=n(3604),t=n(2832),l=n(1113),d=n(7313),i=n(1766),c=n(6417);const u=d.forwardRef((function(e,r){return(0,c.jsx)(s.Z,{ref:r,...e})}));function m(e){let{title:r,children:n,open:s,onClose:d,...m}=e;return(0,c.jsxs)(a.Z,{...m,open:s,TransitionComponent:u,children:[(0,c.jsx)(o.Z,{children:(0,c.jsxs)(t.Z,{direction:"row",sx:{justifyContent:"space-between",alignItems:"center"},children:[(0,c.jsx)(l.Z,{variant:"h2",color:"primary.main",children:r}),(0,c.jsx)(i.Z,{sx:{cursor:"pointer"},onClick:d})]})}),n]})}},5266:function(e,r,n){n.d(r,{h:function(){return o}});var s=n(6031),a=n.n(s);const o=(e,r,n)=>e.map((e=>a().mapKeys(e,((e,s)=>{for(let a=0;a<n.length;a++)if(s===r[a])return n[a];return s}))))},2278:function(e,r,n){n.r(r),n.d(r,{default:function(){return U}});var s=n(7313),a=n(9536),o=n(4713),t=n(4631),l=n(4469),d=n(3604),i=n(6467),c=n(4117),u=n(1095),m=n(8999),h=n(5266),p=n(7825),x=n(2832),j=n(1113),v=n(1550),f=n(3306),Z=n(8797),y=n(1405),g=n(5480),C=n(5627),b=n(1387),w=n(2186),A=n(1322),E=n(6417);function N(e){let{getData:r,open:n,onClose:a,isEdit:o=!1,data:l={}}=e;const[d,i]=(0,s.useState)([]),{control:c,handleSubmit:m,formState:{errors:h},reset:N}=(0,C.cI)({defaultValues:o?{name:l.Name||"",userName:l["User Name"]||"",address:l.Address||"",email:l.Email||"",phone:l["Contact Number"]||"",password:"",companyId:l.companyId||""}:{name:"",userName:"",address:"",email:"",phone:"",password:"",companyId:""}});(0,s.useEffect)((()=>{n&&((0,A.r7)().then((e=>{console.log("heyyy"),i(e)})).catch((e=>{console.error(e),b.Am.error("Failed to fetch companies")})),console.log(l))}),[n]);const S=()=>{a(),N()};return(0,E.jsx)(w.Z,{open:n,fullWidth:!0,onClose:S,title:(o?"Edit":"Add")+" User",children:(0,E.jsx)("form",{onSubmit:m((e=>{const n={...e,role:"company"};(o?(0,A.uz)({userId:l._id,...n}):(0,A.cn)(n)).then((()=>{b.Am.success(`User ${o?"updated":"added"} successfully`),r(),S()})).catch((e=>{var r,n;console.error(e),b.Am.error((null===(r=e.response)||void 0===r||null===(n=r.data)||void 0===n?void 0:n.message)||"Something went wrong")}))})),children:(0,E.jsx)(p.Z,{children:(0,E.jsxs)(x.Z,{direction:"column",sx:{p:2},spacing:2,children:[(0,E.jsx)(j.Z,{variant:"h5",children:"Name"}),(0,E.jsx)(C.Qr,{name:"name",control:c,rules:{required:"Name is required"},render:e=>{var r;let{field:n}=e;return(0,E.jsx)(t.Z,{...n,placeholder:"Enter Name",error:!!h.name,helperText:null===(r=h.name)||void 0===r?void 0:r.message})}}),(0,E.jsx)(j.Z,{variant:"h5",children:"User Name"}),(0,E.jsx)(C.Qr,{name:"userName",control:c,rules:{required:"Username is required"},render:e=>{var r;let{field:n}=e;return(0,E.jsx)(t.Z,{...n,placeholder:"Enter Username",error:!!h.userName,helperText:null===(r=h.userName)||void 0===r?void 0:r.message})}}),(0,E.jsx)(j.Z,{variant:"h5",children:"Address"}),(0,E.jsx)(C.Qr,{name:"address",control:c,rules:{required:"Address is required"},render:e=>{var r;let{field:n}=e;return(0,E.jsx)(t.Z,{...n,placeholder:"Enter Address",error:!!h.address,helperText:null===(r=h.address)||void 0===r?void 0:r.message})}}),(0,E.jsx)(j.Z,{variant:"h5",children:"Email"}),(0,E.jsx)(C.Qr,{name:"email",control:c,rules:{required:"Email is required"},render:e=>{var r;let{field:n}=e;return(0,E.jsx)(t.Z,{...n,placeholder:"Enter Email",error:!!h.email,helperText:null===(r=h.email)||void 0===r?void 0:r.message})}}),(0,E.jsx)(j.Z,{variant:"h5",children:"Phone"}),(0,E.jsx)(C.Qr,{name:"phone",control:c,rules:{required:"Phone number is required",pattern:{value:/^[0-9]{10}$/,message:"Phone number must be exactly 10 digits"}},render:e=>{var r;let{field:n}=e;return(0,E.jsx)(t.Z,{...n,placeholder:"Enter Phone",error:!!h.phone,helperText:null===(r=h.phone)||void 0===r?void 0:r.message})}}),(0,E.jsx)(j.Z,{variant:"h5",children:"Password"}),(0,E.jsx)(C.Qr,{name:"password",control:c,rules:{required:!o&&"Password is required"},render:e=>{var r;let{field:n}=e;return(0,E.jsx)(t.Z,{...n,type:"password",placeholder:"Enter Password",error:!!h.password,helperText:null===(r=h.password)||void 0===r?void 0:r.message})}}),(0,E.jsxs)(v.Z,{fullWidth:!0,error:!!h.companyId,children:[(0,E.jsx)(f.Z,{id:"companyId-label",children:"Company"}),(0,E.jsx)(C.Qr,{name:"companyId",control:c,rules:{required:"Company is required"},render:e=>{let{field:r}=e;return(0,E.jsx)(Z.Z,{...r,labelId:"companyId-label",label:"Company",showSearch:!0,MenuProps:{PaperProps:{style:{maxHeight:300}}},children:d.map((e=>(0,E.jsx)(y.Z,{value:e._id,children:e.name},e._id)))})}}),h.companyId&&(0,E.jsx)(g.Z,{children:h.companyId.message})]}),(0,E.jsx)(u.Z,{variant:"contained",type:"submit",sx:{width:"150px"},children:o?"Update":"Create"})]})})})})}const S=["Name","User Name","Company Name","Contact Number","Address","Email","Role","Status"];function I(e){let{data:r,updateData:n,companyData:p}=e;const[x,j]=(0,s.useState)(!1),[v,f]=(0,s.useState)(),[Z,y]=(0,s.useState)(null),[g,C]=(0,s.useState)(!1),[w,I]=(0,s.useState)(null),q=(0,h.h)(r,["name","userName","company","phone","address","email","role","status"],S);return(0,E.jsxs)(E.Fragment,{children:[(0,E.jsx)(a.Z,{sx:{mb:2},children:(0,E.jsx)(o.Z,{options:p||[],getOptionLabel:e=>e.name||"",value:Z,onChange:(e,r)=>{y(r),n(null===r||void 0===r?void 0:r._id)},renderInput:e=>(0,E.jsx)(t.Z,{...e,label:"Search Company",variant:"outlined",size:"small",fullWidth:!0})})}),x&&(0,E.jsx)(N,{getData:n,open:x,onClose:()=>{j(!1)},data:v,isEdit:!0}),(0,E.jsxs)(l.Z,{open:g,onClose:()=>C(!1),children:[(0,E.jsx)(d.Z,{children:"Confirm Delete"}),(0,E.jsxs)(i.Z,{children:["Are you sure you want to delete user `",null===w||void 0===w?void 0:w.Name,"`?"]}),(0,E.jsxs)(c.Z,{children:[(0,E.jsx)(u.Z,{onClick:()=>C(!1),children:"Cancel"}),(0,E.jsx)(u.Z,{onClick:async()=>{try{await(0,A.h8)(w._id),b.Am.success("User deleted successfully"),n(),C(!1),I(null)}catch(s){var e,r;console.error(s),b.Am.error((null===(e=s.response)||void 0===e||null===(r=e.data)||void 0===r?void 0:r.message)||"Error deleting user")}},color:"error",children:"Delete"})]})]}),(0,E.jsx)(m.Z,{data:q,header:S,isShowSerialNo:!0,isShowAction:!0,actions:["Edit","delete"],onActionChange:async e=>{console.log(e),"delete"==e.action?(console.log(e.data),I(e.data),C(!0)):"Edit"==e.action?(j(!0),console.log(e.data),f(e.data),console.log("edit company")):f()}})]})}var q=n(2040),_=n(3497);function k(e){let{buttonClick:r}=e;return(0,E.jsx)(_.Z,{children:(0,E.jsxs)(x.Z,{direction:"row",sx:{justifyContent:"space-between",alignItems:"center"},children:[(0,E.jsx)(j.Z,{variant:"h3",color:"secondary.main",children:"Manage Users"}),(0,E.jsx)(u.Z,{variant:"contained",startIcon:(0,E.jsx)(q.Z,{}),sx:{backgroundColor:"secondary.main"},onClick:r,children:"Add User"})]})})}function U(){const[e,r]=(0,s.useState)(!1),[n,a]=(0,s.useState)([]),o=e=>{(0,A.AW)(e).then((e=>{a(e)})).catch((e=>{console.log(e),b.Am.error(e.response.data.message)}))},[t,l]=(0,s.useState)([]),d=()=>{(0,A.r7)().then((e=>{l(e)})).catch((e=>{console.log(e),b.Am.error(e.response.data.message)}))};return(0,s.useEffect)((()=>{d(),o()}),[]),(0,E.jsxs)(x.Z,{direction:"column",gap:2,children:[(0,E.jsx)(N,{open:e,getData:o,getAllCompanies:d,onClose:()=>{r(!1)}}),(0,E.jsx)(k,{buttonClick:()=>r(!0)}),(0,E.jsx)(I,{data:n,updateData:o,companyData:t})]})}}}]);