"use strict";(self.webpackChunkberry_free_material_react_cra=self.webpackChunkberry_free_material_react_cra||[]).push([[865],{4865:function(e,t,a){a.r(t),a.d(t,{default:function(){return v}});var n=a(7313),o=a(3497),c=a(1629),r=a(6835),s=a(3477),i=a(4076),l=a(7478),d=a(3467),u=a(1095),h=a(9848),x=a(6167),j=a(5842),g=a(1322),m=a(1387),Z=a(6417);function p(e){let{data:t,header:a,isShowSerialNo:p=!1,isShowAction:f=!1,actions:y=["Edit","Delete"],onActionChange:k,refresh:S,onClickAction:b}=e;const[A,v]=(0,n.useState)(null),[D,I]=(0,n.useState)(null),[_,w]=(0,n.useState)(!1),C=(e,t)=>{(0,g.jK)({status:t,allocId:e}).then((e=>{console.log(e),m.Am.success("status updated successfully"),S({status:"ongoing"})})).catch((e=>{console.log(e),m.Am.error(e.response.data.message)}))};return(0,Z.jsxs)(o.Z,{children:[(0,Z.jsx)(c.Z,{children:(0,Z.jsxs)(r.Z,{children:[(0,Z.jsx)(s.Z,{children:(0,Z.jsxs)(i.Z,{children:[p&&(0,Z.jsx)(l.Z,{sx:{color:"primary.main"},children:"SLNO"}),a.map(((e,t)=>(0,Z.jsx)(l.Z,{sx:{color:"primary.main"},children:e},t))),f&&(0,Z.jsx)(l.Z,{sx:{color:"primary.main"},children:"Action"})]})}),(0,Z.jsx)(d.Z,{children:t.map(((e,t)=>{return(0,Z.jsxs)(i.Z,{onClick:()=>(e=>{b&&b(e)})(e._id),children:[p&&(0,Z.jsx)(l.Z,{children:t+1}),(0,Z.jsx)(l.Z,{children:e.truck.registrationNumber}),(0,Z.jsx)(l.Z,{children:e.allocation.DOBookingId.partyId.name}),(0,Z.jsx)(l.Z,{children:e.allocation.DOBookingId.partyId.locationId.name}),(0,Z.jsx)(l.Z,{children:e.allocation.DOBookingId.partyId.contactNumber}),(0,Z.jsxs)(l.Z,{children:["\u20b9",e.allocation.DOBookingId.rate]}),(0,Z.jsx)(l.Z,{children:(a=e.availableFrom,new Date(a).toLocaleDateString("en-US",{day:"numeric",month:"short",year:"numeric"}))}),(0,Z.jsx)(l.Z,{children:"allocated"===e.allocation.status?(0,Z.jsx)(u.Z,{variant:"contained",onClick:()=>C(e.allocation._id,"ongoing"),children:"Move to Live"}):"ongoing"===e.allocation.status?(0,Z.jsx)(u.Z,{variant:"contained",onClick:()=>C(e.allocation._id,"done"),children:"Move to Done"}):"expired"===e.allocation.status?(0,Z.jsx)(u.Z,{variant:"contained",disabled:!0,children:"Expired"}):null}),f&&(0,Z.jsx)(l.Z,{children:(0,Z.jsx)(h.Z,{data:e,onActionChange:e=>{k(e)},actions:y})})]},t);var a}))})]})}),A&&(0,Z.jsx)(x.Z,{open:_,close:()=>{v(null),w(!1)},type:A}),D&&(0,Z.jsx)(j.Z,{open:_,close:()=>{I(null),w(!1)},doId:D})]})}var f=a(5266);const y=["RegNo","party","location","contact","rate","Date","status"];function k(e){let{data:t,updateStatus:a,updateData:n}=e;const o=(0,f.h)(t,["registrationNumber","party","location","contact","rate","Date","status"],y);return(0,Z.jsx)(Z.Fragment,{children:(0,Z.jsx)(p,{data:o,header:y,isShowSerialNo:!0,isShowAction:!0,actions:["cancel"],refresh:n,onActionChange:e=>{console.log(e),"cancel"==e.action&&(console.log(e.data._id),a({truckId:"661bf9b734601df26a2d1bc3",status:"inqueue"}).then((e=>{console.log(e.message),m.Am.success(e.message),n({status:"allocated"})})).catch((e=>{console.error(e),m.Am.error("Error occured while updating")})))}})})}var S=a(2832),b=a(1113);function A(){return(0,Z.jsx)(o.Z,{children:(0,Z.jsx)(S.Z,{direction:"row",sx:{justifyContent:"space-between",alignItems:"center"},children:(0,Z.jsx)(b.Z,{variant:"h3",color:"secondary.main",children:"Allocated Trucks"})})})}function v(){const[e,t]=(0,n.useState)([]),a=e=>{(0,g.Jr)(e).then((e=>{t(e)})).catch((e=>{console.log(e)}))};return(0,n.useEffect)((()=>{a({status:"allocated"})}),[]),(0,Z.jsxs)(S.Z,{direction:"column",gap:2,children:[(0,Z.jsx)(A,{}),(0,Z.jsx)(k,{data:e,updateStatus:g.Au,updateData:a})]})}}}]);