"use strict";(self.webpackChunkberry_free_material_react_cra=self.webpackChunkberry_free_material_react_cra||[]).push([[863],{8999:function(e,t,n){n.d(t,{Z:function(){return m}});var a=n(7313),r=n(3497),o=n(1629),l=n(6835),s=n(3477),i=n(4076),c=n(7478),d=n(3467),u=n(1095),h=n(9848),f=n(6167),p=n(5842),x=n(6417);function m(e){let{data:t,header:n,isShowSerialNo:m=!1,isShowAction:j=!1,actions:g=["Edit","Delete"],onActionChange:y,onClickAction:Z,refreshData:v}=e;const[b,S]=(0,a.useState)(null),[I,D]=(0,a.useState)(null),[C,A]=(0,a.useState)(null),[k,w]=(0,a.useState)(null),[O,F]=(0,a.useState)(!1);return(0,x.jsxs)(r.Z,{children:[(0,x.jsx)(o.Z,{children:(0,x.jsxs)(l.Z,{children:[(0,x.jsx)(s.Z,{children:(0,x.jsxs)(i.Z,{children:[m&&(0,x.jsx)(c.Z,{sx:{color:"primary.main"},children:"SLNO"}),n.map(((e,t)=>(0,x.jsx)(c.Z,{sx:{color:"primary.main"},children:e},t))),j&&(0,x.jsx)(c.Z,{sx:{color:"primary.main"},children:"Action"})]})}),(0,x.jsx)(d.Z,{children:t.map(((e,t)=>(0,x.jsxs)(i.Z,{onClick:()=>(e=>{Z&&Z(e)})(e._id),children:[m&&(0,x.jsx)(c.Z,{children:t+1}),n.map(((t,n)=>{if("IMAGE"===t.toUpperCase())return(0,x.jsx)(c.Z,{children:(0,x.jsx)("img",{style:{height:"100px"},src:`${e[`${t}`]}`,alt:"img"})},n);if("allocated"!=e.status&&"ALLOCATION"===t.toUpperCase())return console.log("dfffffffffffffffffffffffffffffffffffff"),console.log(e),(0,x.jsx)(c.Z,{children:(0,x.jsx)(u.Z,{variant:"contained",onClick:()=>(e=>{console.log("select alloccccccccccccccccccccccc"),console.log(e),console.log("heeeeeeeeeeeeeeeeeeeeeeedataaaaaaaaaaaaaaaa"),S(e.truckType),D(e.date),w(e.doId),console.log(e.truckType),F(!0)})({doId:e._id,truckType:e.truckType,date:e["available from"]}),children:"Allocate"})},n);if("allocated"==e.status&&"ALLOCATION"===t.toUpperCase())return(0,x.jsx)(c.Z,{children:(0,x.jsx)(u.Z,{variant:"contained",onClick:()=>{return t=e._id,A(t),void F(!0);var t},children:"View Allocation"})},n);if("VIEW DO"===t.toUpperCase()){const t=e["view DO"]||e.deliveryOrderId&&e.deliveryOrderId.doLink;return t?(0,x.jsx)(c.Z,{children:(0,x.jsx)(u.Z,{variant:"contained",onClick:()=>window.open(t,"_blank"),children:"View File"})},n):(0,x.jsx)(c.Z,{children:(0,x.jsx)(u.Z,{variant:"contained",disabled:!0,children:"No File"})},n)}return"isHighRangeArea"!=e.status&&"ISHIGHRANGEAREA"===t.toUpperCase()?(0,x.jsx)(c.Z,{children:e[`${t}`]?"Yes":"No"},n):"STATUS"===t.toUpperCase()?(0,x.jsx)(c.Z,{children:e[`${t}`]?"Active":"Inactive"},n):(0,x.jsx)(c.Z,{children:e[`${t}`]},n)})),j&&(0,x.jsx)(c.Z,{children:(0,x.jsx)(h.Z,{data:e,onActionChange:e=>{y(e)},actions:g})})]},t)))})]})}),b&&(0,x.jsx)(f.Z,{open:O,close:()=>{S(null),console.log("heeeeeeeeeeeeeeeeeeeeeeeey"),v(),F(!1)},doId:k,date:I,type:b}),C&&(0,x.jsx)(p.Z,{open:O,close:()=>{A(null),v(),F(!1)},doId:C})]})}},7713:function(e,t,n){var a=n(421),r=n(7120);const o=(0,a.ZF)({apiKey:"AIzaSyCBwJaecXhomn4kYayf-XMwOVfBZZyvtZ8",authDomain:"container-management-e3afb.firebaseapp.com",projectId:"container-management-e3afb",storageBucket:"container-management-e3afb.appspot.com",messagingSenderId:"355036042666",appId:"1:355036042666:web:d26919044f6afc7be387d3"}),l=(0,r.cF)(o);t.Z=l},5266:function(e,t,n){n.d(t,{h:function(){return o}});var a=n(6031),r=n.n(a);const o=(e,t,n)=>e.map((e=>r().mapKeys(e,((e,a)=>{for(let r=0;r<n.length;r++)if(a===t[r])return n[r];return a}))))},6863:function(e,t,n){n.r(t),n.d(t,{default:function(){return z}});var a=n(7313),r=n(7890),o=n(2832),l=n(8999),s=n(5266),i=n(9536),c=n(1095),d=n(4469),u=n(4117),h=n(6467),f=n(7762),p=n(3604),x=n(1550),m=n(7131),j=n(1198),g=n(4631),y=n(4605),Z=n(3208),v=n(5904),b=n(57),S=n(658),I=n.n(S),D=n(3306),C=n(8797),A=n(1405),k=n(5480),w=n(1113),O=n(5627),F=n(1322),N=n(1387),_=n(6417);function T(e){const[t,n]=a.useState(!1),[r,o]=a.useState([]),[l,s]=a.useState(null),{control:S,handleSubmit:T,reset:B,formState:{errors:$}}=(0,O.cI)({defaultValues:{type:20}}),E=new Date,M=E,U=(0,b.E)(E,30),q=new Date(M),V=`${q.getFullYear()}-${String(q.getMonth()+1).padStart(2,"0")}-${String(q.getDate()).padStart(2,"0")}`,W=new Date(U),Y=`${W.getFullYear()}-${String(W.getMonth()+3).padStart(2,"0")}-${String(W.getDate()).padStart(2,"0")}`,L=()=>{e.onClose(),B(),n(!1)};a.useEffect((()=>{(0,F.a2)({companyId:e.data}).then((e=>{console.log(e),o(e)})).catch((e=>{console.log(e),N.Am.error(e)}))}),[e.data]),a.useEffect((()=>{n(e.open)}),[e]);return(0,_.jsx)(a.Fragment,{children:(0,_.jsx)(Z._,{dateAdapter:v.y,children:(0,_.jsx)(d.Z,{fullWidth:!0,maxWidth:"sm",open:t,onClose:L,children:(0,_.jsxs)("form",{onSubmit:T((async t=>{if(!l)return void N.Am.error("Please select a date");if(!e.doId)return void N.Am.error("Delivery order Id missing");const n=I()(l).format("YYYY-MM-DD"),{type:a,rate:r,party:o}=t;console.log({party:o,availableFrom:n,type:a,doId:e.doId,companyId:e.data,rate:r});try{await(0,F.cW)({partyId:o,deliveryOrderId:e.doId,availableFrom:n,truckType:a,rate:r,companyId:e.data}),N.Am.success("Do Created Successfully, now you can allocate truck"),L()}catch(s){console.error("Failed to create DO:",s),N.Am.error("Failed to create DO")}})),children:[(0,_.jsx)(p.Z,{children:"ADD Booking"}),(0,_.jsx)(m.Z,{"aria-label":"close",onClick:L,sx:{position:"absolute",right:8,top:8,color:e=>e.palette.grey[500]},children:(0,_.jsx)(j.Z,{})}),(0,_.jsxs)(h.Z,{children:[(0,_.jsx)(f.Z,{children:"Upload Delivery Order"}),(0,_.jsxs)(i.Z,{noValidate:!0,component:"form",sx:{display:"flex",flexDirection:"column",m:"auto",width:"fit-content"},children:[(0,_.jsxs)(x.Z,{error:Boolean($.driver),children:[(0,_.jsx)(D.Z,{id:"type-select-label",children:"Party"}),(0,_.jsx)(O.Qr,{name:"party",control:S,render:e=>{let{field:t}=e;return(0,_.jsxs)(C.Z,{...t,labelId:"type-select-label",id:"type-select",label:"party",value:t.value||"",onChange:e=>{t.onChange(e.target.value)},children:[(0,_.jsx)(A.Z,{value:"",children:(0,_.jsx)("em",{children:"None"})}),r.map((e=>(0,_.jsxs)(A.Z,{value:e._id,children:[e.name," Mob: ",e.contactNumber," Address: ",e.address," "]},e._id)))]})},rules:{required:"Party is required"}}),$.party&&(0,_.jsx)(k.Z,{children:$.party.message})]}),(0,_.jsx)(x.Z,{sx:{mt:2,minWidth:120},children:(0,_.jsx)(y.M,{label:"From Date",value:l,onChange:e=>s(e),minDate:I()(V),maxDate:I()(Y),renderInput:e=>(0,_.jsx)(g.Z,{...e})})}),(0,_.jsxs)(x.Z,{error:Boolean($.type),sx:{mt:2},children:[(0,_.jsx)(D.Z,{id:"type-select-label",children:"Type"}),(0,_.jsx)(O.Qr,{name:"type",control:S,defaultValue:20,render:e=>{let{field:t}=e;return(0,_.jsxs)(C.Z,{...t,labelId:"type-select-label",id:"type-select",label:"Type",onChange:e=>t.onChange(e.target.value),children:[(0,_.jsx)(A.Z,{value:20,children:"20 FT"}),(0,_.jsx)(A.Z,{value:40,children:"40 FT"})]})},rules:{required:"Type is required"}}),$.type&&(0,_.jsx)(k.Z,{children:$.type.message})]}),(0,_.jsx)(w.Z,{variant:"h5",children:"Rate"}),(0,_.jsx)(O.Qr,{name:"rate",control:S,render:e=>{let{field:t}=e;return(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(g.Z,{...t,placeholder:"Enter Rate"}),$.rate&&(0,_.jsx)("span",{style:{color:"#f00"},children:$.rate.message})]})},rules:{required:"Rate is required"}})]})]}),(0,_.jsx)(u.Z,{children:(0,_.jsx)(c.Z,{variant:"contained",type:"submit",children:"ADD Booking"})})]})})})})}const B=["name","view DO","upload date","status"];function $(e){let{partyId:t,data:n,updateData:o}=e;const[i,c]=(0,a.useState)(!1),[d,u]=(0,a.useState)({}),h=(0,r.s0)(),f=(0,s.h)(n,["name","link","uploadDate","status"],B),p="admin"===localStorage.getItem("role");return(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(T,{open:i,onClose:()=>{c(!1),o(t),h("/doBooking")},isEdit:!0,getBookings:o,data:null===d||void 0===d?void 0:d.companyId,doId:null===d||void 0===d?void 0:d._id}),(0,_.jsx)(l.Z,{data:f,header:B,isShowSerialNo:!0,isShowAction:!1,actions:p?["addBooking","delete"]:["delete"],onActionChange:e=>{console.log(e),"delete"==e.action?(console.log(e.data._id),u(e.data),(0,F.KI)(e.data._id).then((()=>{})).catch((e=>{console.error(e),N.Am.error(e.response.data.message)}))):"addBooking"==e.action?(u(e.data),console.log(e.data),c(!0),console.log("add to booking"),console.log(e.data._id)):u(),o(t)}})]})}var E=n(3497);function M(){return(0,_.jsx)(E.Z,{children:(0,_.jsx)(o.Z,{direction:"row",sx:{justifyContent:"space-between",alignItems:"center"},children:(0,_.jsx)(w.Z,{variant:"h3",color:"secondary.main",children:"Open DO"})})})}var U=n(7713),q=n(9176),V=n(7120),W=n(3950),Y=n(8372),L=n(2549);function R(e){const[t,n]=a.useState(!1),[r,o]=a.useState(""),[l,s]=a.useState(null),{register:i,handleSubmit:x,setValue:m,formState:{errors:j}}=(0,O.cI)({defaultValues:{}}),y=()=>{e.onClose(),s(null),o(""),n(!1)};a.useEffect((()=>{n(e.open)}),[e.open]);return(0,_.jsx)(a.Fragment,{children:(0,_.jsx)(d.Z,{fullWidth:!0,maxWidth:"sm",open:t,onClose:y,children:(0,_.jsxs)("form",{onSubmit:x((async e=>{const{file:t,name:n}=e;if(!t)return void N.Am.error("Please choose a file");const a=`${n}-${(0,L.Z)()}`;console.log(a),console.log("-------------------------------------------------------------------------------");const r=(0,V.iH)(U.Z,`/DoBookings/${a}`),o=(0,V.B0)(r,t);o.on("state_changed",(e=>{const t=Math.round(e.bytesTransferred/e.totalBytes*100);s(t),console.log(t)}),(e=>console.log(e)),(()=>{(0,V.Jt)(o.snapshot.ref).then((e=>{try{(0,F.kR)({doLink:e,name:n,uniqueName:a}).then((()=>{y()})).catch((e=>{console.log(e),N.Am.error(e.response.data.message)}))}catch(t){console.error("Failed to create DO:",t),N.Am.error("Failed to create DO")}}))}))})),children:[(0,_.jsx)(p.Z,{children:"Upload DO"}),(0,_.jsxs)(h.Z,{children:[(0,_.jsx)(f.Z,{children:"Upload Delivery Order."}),(0,_.jsx)(g.Z,{label:"Name",variant:"outlined",fullWidth:!0,margin:"normal",...i("name",{required:!0}),error:!!j.name,helperText:j.name?"Name is required":""}),(0,_.jsx)("input",{accept:"image/*,.pdf",style:{display:"none"},id:"raised-button-file",type:"file",onChange:e=>{const t=e.target.files[0];o(t?t.name:""),m("file",t)}}),(0,_.jsxs)("label",{htmlFor:"raised-button-file",children:[(0,_.jsx)(Y.Z,{display:"flex",justifyContent:"center",alignItems:"center",height:150,children:(0,_.jsx)(W.Z,{style:{fontSize:100}})}),null!==l&&(0,_.jsx)(Y.Z,{sx:{width:"100%"},children:(0,_.jsx)(H,{value:l})})]}),r&&(0,_.jsx)(k.Z,{children:r})]}),(0,_.jsx)(u.Z,{children:(0,_.jsx)(c.Z,{variant:"contained",type:"submit",children:"Submit"})})]})})})}function H(e){return(0,_.jsxs)(Y.Z,{sx:{display:"flex",alignItems:"center"},children:[(0,_.jsx)(Y.Z,{sx:{width:"100%",mr:1},children:(0,_.jsx)(q.Z,{variant:"determinate",...e})}),(0,_.jsx)(Y.Z,{sx:{minWidth:35},children:(0,_.jsx)(w.Z,{variant:"body2",color:"text.secondary",children:`${Math.round(e.value)}%`})})]})}function z(){const[e,t]=(0,a.useState)(!1),[n,l]=(0,a.useState)([]);let{partyId:s}=(0,r.UO)();const i=async e=>{try{let t={status:1};e&&(t.partyId=e);const n=await(0,F.S1)(t);l(n)}catch(t){console.log(t)}};return(0,a.useEffect)((()=>{i(s)}),[]),(0,_.jsxs)(o.Z,{direction:"column",gap:2,children:[(0,_.jsx)(R,{data:s,open:e,getBookings:i,onClose:()=>{t(!1),i(s)}}),(0,_.jsx)(M,{partyId:s,buttonClick:()=>t(!0)}),(0,_.jsx)($,{partyId:s,data:n,updateData:i})]})}},3950:function(e,t,n){var a=n(4836);t.Z=void 0;var r=a(n(5045)),o=n(6417),l=(0,r.default)((0,o.jsx)("path",{d:"M19.35 10.04C18.67 6.59 15.64 4 12 4 9.11 4 6.6 5.64 5.35 8.04 2.34 8.36 0 10.91 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.65-4.96zM14 13v4h-4v-4H7l5-5 5 5h-3z"}),"CloudUpload");t.Z=l},57:function(e,t,n){function a(e){const t=Object.prototype.toString.call(e);return e instanceof Date||"object"===typeof e&&"[object Date]"===t?new e.constructor(+e):"number"===typeof e||"[object Number]"===t||"string"===typeof e||"[object String]"===t?new Date(e):new Date(NaN)}n.d(t,{E:function(){return o}});function r(e,t){return e instanceof Date?new e.constructor(t):new Date(t)}function o(e,t){const n=a(e);return isNaN(t)?r(e,NaN):t?(n.setDate(n.getDate()+t),n):n}}}]);