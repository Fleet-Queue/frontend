"use strict";(self.webpackChunkberry_free_material_react_cra=self.webpackChunkberry_free_material_react_cra||[]).push([[865],{5266:function(e,t,n){n.d(t,{h:function(){return r}});var a=n(6031),o=n.n(a);const r=(e,t,n)=>e.map((e=>o().mapKeys(e,((e,a)=>{for(let o=0;o<n.length;o++)if(a===t[o])return n[o];return a}))))},4865:function(e,t,n){n.r(t),n.d(t,{default:function(){return _}});var a=n(7313),o=n(3497),r=n(1629),c=n(6835),s=n(3477),i=n(4076),l=n(7478),d=n(3467),u=n(1095),h=n(9848),x=n(6167),j=n(5842),m=n(1322),g=n(1387),p=n(6417);function Z(e){let{data:t,header:n,isShowSerialNo:Z=!1,isShowAction:f=!1,actions:y=["Edit","Delete"],onActionChange:k,refresh:S,onClickAction:v}=e;const[A,_]=(0,a.useState)(null),[b,D]=(0,a.useState)(null),[I,w]=(0,a.useState)(!1),C=(e,t)=>{(0,m.jK)({status:t,allocId:e}).then((e=>{console.log(e),g.Am.success("status updated successfully"),S({status:"ongoing"})})).catch((e=>{console.log(e),g.Am.error(e.response.data.message)}))};return(0,p.jsxs)(o.Z,{children:[(0,p.jsx)(r.Z,{children:(0,p.jsxs)(c.Z,{children:[(0,p.jsx)(s.Z,{children:(0,p.jsxs)(i.Z,{children:[Z&&(0,p.jsx)(l.Z,{sx:{color:"primary.main"},children:"SLNO"}),n.map(((e,t)=>(0,p.jsx)(l.Z,{sx:{color:"primary.main"},children:e},t))),f&&(0,p.jsx)(l.Z,{sx:{color:"primary.main"},children:"Action"})]})}),(0,p.jsx)(d.Z,{children:t.map(((e,t)=>{return(0,p.jsxs)(i.Z,{onClick:()=>(e=>{v&&v(e)})(e._id),children:[Z&&(0,p.jsx)(l.Z,{children:t+1}),(0,p.jsx)(l.Z,{children:e.truck.registrationNumber}),(0,p.jsx)(l.Z,{children:e.allocation.DOBookingId.partyId.name}),(0,p.jsx)(l.Z,{children:e.allocation.DOBookingId.partyId.locationId.name}),(0,p.jsx)(l.Z,{children:e.allocation.DOBookingId.partyId.contactNumber}),(0,p.jsxs)(l.Z,{children:["\u20b9",e.allocation.DOBookingId.rate]}),(0,p.jsx)(l.Z,{children:(n=e.availableFrom,new Date(n).toLocaleDateString("en-US",{day:"numeric",month:"short",year:"numeric"}))}),(0,p.jsx)(l.Z,{children:"allocated"===e.allocation.status?(0,p.jsx)(u.Z,{variant:"contained",disabled:!0,onClick:()=>C(e.allocation._id,"ongoing"),children:"Move to Live"}):"ongoing"===e.allocation.status?(0,p.jsx)(u.Z,{variant:"contained",disabled:!0,onClick:()=>C(e.allocation._id,"done"),children:"Move to Done"}):"expired"===e.allocation.status?(0,p.jsx)(u.Z,{variant:"contained",disabled:!0,children:"Expired"}):null}),f&&(0,p.jsx)(l.Z,{children:(0,p.jsx)(h.Z,{data:e,onActionChange:e=>{k(e)},actions:y})})]},t);var n}))})]})}),A&&(0,p.jsx)(x.Z,{open:I,close:()=>{_(null),w(!1)},type:A}),b&&(0,p.jsx)(j.Z,{open:I,close:()=>{D(null),w(!1)},doId:b})]})}var f=n(5266);const y=["RegNo","party","location","contact","rate","Date","status"];function k(e){let{data:t,updateStatus:n,updateData:a}=e;const o=(0,f.h)(t,["registrationNumber","party","location","contact","rate","Date","status"],y);return(0,p.jsx)(p.Fragment,{children:(0,p.jsx)(Z,{data:o,header:y,isShowSerialNo:!0,isShowAction:!0,actions:["cancel"],refresh:a,onActionChange:e=>{console.log(e),"cancel"==e.action&&(console.log(e.data._id),n({truckId:e.data._id,status:"inqueue"}).then((e=>{console.log(e.message),g.Am.success(e.message),a({status:"allocated"})})).catch((e=>{console.error(e),g.Am.error("Error occured while updating")})))}})})}var S=n(2832),v=n(1113);function A(){return(0,p.jsx)(o.Z,{children:(0,p.jsx)(S.Z,{direction:"row",sx:{justifyContent:"space-between",alignItems:"center"},children:(0,p.jsx)(v.Z,{variant:"h3",color:"secondary.main",children:"Allocated Trucks"})})})}function _(){const[e,t]=(0,a.useState)([]),n=e=>{(0,m.Jr)(e).then((e=>{t(e)})).catch((e=>{console.log(e)}))};return(0,a.useEffect)((()=>{n({status:"allocated"})}),[]),(0,p.jsxs)(S.Z,{direction:"column",gap:2,children:[(0,p.jsx)(A,{}),(0,p.jsx)(k,{data:e,updateStatus:m.Au,updateData:n})]})}}}]);